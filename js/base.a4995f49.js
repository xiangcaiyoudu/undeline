(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["base"],{"3a56":function(e,n,t){},"5ec1":function(e,n,t){},"8fe8":function(e,n,t){},a440:function(e,n,t){"use strict";var o=t("8fe8"),r=t.n(o);r.a},a9f22:function(e,n,t){"use strict";var o=t("5ec1"),r=t.n(o);r.a},b382:function(e,n,t){"use strict";var o=t("3a56"),r=t.n(o);r.a},ba3b:function(e,n,t){"use strict";t.r(n);var o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"login"},[t("div",{staticClass:"login-wrap"},[t("div",{class:e.iconClass,on:{click:e.toggle}}),t("transition",{attrs:{name:"el-zoom-in-center",mode:"out-in"}},[t(e.formLogin?"formLogin":"qrcodeLogin",{tag:"components",staticClass:"login-item"})],1)],1)])},r=[],i=(t("b3f9"),t("d780"),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"form"},[t("header",[e._v("账号密码登陆")]),t("el-form",{ref:"form",attrs:{size:"normal",model:e.form}},[t("el-form-item",{attrs:{prop:"loginName",rules:e.rules.loginName}},[t("el-input",{attrs:{placeholder:"请输入用户名"},nativeOn:{keyup:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.login(n)}},model:{value:e.form.loginName,callback:function(n){e.$set(e.form,"loginName",n)},expression:"form.loginName"}})],1),t("el-form-item",{attrs:{prop:"passwd",rules:e.rules.passwd}},[t("el-input",{attrs:{placeholder:"请输入密码",type:"password"},nativeOn:{keyup:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.login(n)}},model:{value:e.form.passwd,callback:function(n){e.$set(e.form,"passwd",n)},expression:"form.passwd"}})],1),e.codeVisible?[t("el-form-item",{staticClass:"form--code",attrs:{prop:"code",rules:e.rules.code}},[t("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.form.code,callback:function(n){e.$set(e.form,"code",n)},expression:"form.code"}}),t("img",{attrs:{src:e.codeUrl},on:{click:e.initCode}})],1)]:e._e()],2),t("el-row",{attrs:{type:"flex",justify:"between"}},[t("el-col",[t("el-checkbox",[e._v("记住密码")])],1),t("el-col",{attrs:{align:"right"}},[t("el-link",{attrs:{type:"primary"}},[e._v("忘记密码?")])],1)],1),t("footer",[t("el-button",{attrs:{size:"large",type:"primary"},on:{click:e.login}},[e._v("登陆")])],1)],1)}),a=[],s=(t("b449"),t("e980"));t("7ae7");function l(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function c(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,n,t){return n&&c(e.prototype,n),t&&c(e,t),e}var f=t("a538"),d=t("fed1"),m=t.n(d),g=function(){function e(){l(this,e)}return u(e,null,[{key:"loginQrcode",value:function(e){return"".concat("http://47.95.205.99","/supplier/weChat/loginQrcode?sysType=manage&state=").concat(e)}},{key:"loginPolling",value:function(e){return f["a"].post("/supplier/weChat/pcPolling",m.a.stringify(e))}},{key:"isNeedCode",value:function(){return f["a"].post("/supplier/user/isNeedCode")}},{key:"loginForm",value:function(e){return f["a"].post("/supplier/user/accountLogin",m.a.stringify(e))}},{key:"logout",value:function(){return f["a"].post("/supplier/user/loginOut")}}]),e}(),p=g,h=t("9ac6"),v=function(){function e(){l(this,e)}return u(e,null,[{key:"getCode",value:function(){return"http://47.95.205.99/supplier/user/getCode?id="+(new Date).getTime()+"&machineCode="+Object(h["a"])("machineCode")}},{key:"getWechatCode",value:function(){return"http://47.95.205.99/supplier/weChat/followQrcode"}}]),e}(),b=v,y={name:"formLogin",data:function(){return{form:{loginName:"",passwd:"",code:""},rules:{loginName:[{required:!0,message:"请输入用户名",trigger:"blur"}],passwd:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},codeVisible:!1,codeUrl:""}},methods:{initCode:function(){console.system("login[form] => fn:initCode"),this.codeUrl=b.getCode()},initTime:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.system("login[form] => fn:initTime"),n.next=3,p.isNeedCode();case 3:t=n.sent,e.codeVisible=510==t.resultCode;case 5:case"end":return n.stop()}}),n)})))()},login:function(){var e=this;console.system("login[form] => fn:login"),this.$refs["form"].validate(function(){var n=Object(s["a"])(regeneratorRuntime.mark((function n(t){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",!1);case 2:return n.next=4,p.loginForm(e.form);case 4:if(o=n.sent,200==o.resultCode){n.next=9;break}return e.initTime(),e.$message.warning(o.resultMsg),n.abrupt("return",!1);case 9:Object(h["b"])("token",o.data),e.$router.push("/system/user");case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},onInput:function(e,n){console.log(e,n)}},mounted:function(){this.initCode(),this.initTime()}},C=y,w=(t("a440"),t("623f")),k=Object(w["a"])(C,i,a,!1,null,"2637ed31",null),x=k.exports,O=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"code"},[t("header",[e._v("二维码登陆")]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loginConf.loading,expression:"loginConf.loading"}],on:{click:e.init}},[t("img",{attrs:{src:e.loginConf.data}})]),t("p",[e._v("请使用微信扫描二维码")])])},_=[],j=t("3e2f"),L={name:"qrcodeLogin",data:function(){return{loginConf:{loading:!0,randomID:"",data:""}}},methods:{init:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return clearTimeout(e.timer),e.loginConf.data="",e.loginConf.loading=!0,e.loginConf.randomID=Object(j["d"])(),n.next=6,p.loginQrcode(e.loginConf.randomID);case 6:t=n.sent,setTimeout((function(){e.loginConf.data=t,e.loginConf.loading=!1,e.loginPolling()}),300);case 8:case"end":return n.stop()}}),n)})))()},loginPolling:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,p.loginPolling({state:e.loginConf.randomID});case 2:t=n.sent,console.log(t),t.data?(Object(h["b"])("token",t.data),e.$router.push("/system/user")):e.timer=setTimeout(e.loginPolling,3e3);case 5:case"end":return n.stop()}}),n)})))()}},mounted:function(){this.init()},beforeDestroy:function(){clearTimeout(this.timer)}},$=L,q=(t("b382"),Object(w["a"])($,O,_,!1,null,"7161e03c",null)),N=q.exports,T={name:"pageLogin",components:{formLogin:x,qrcodeLogin:N},computed:{formLogin:function(){return"qrcode"!=this.$route.query.type},iconClass:function(){return"icon "+(this.formLogin?"icon--form":"icon--qrcode")}},methods:{toggle:function(){var e=this.formLogin?"qrcode":"form";this.$router.replace({path:"login",query:{type:e}})}},mounted:function(){}},R=T,P=(t("a9f22"),Object(w["a"])(R,o,r,!1,null,"6a66fe3c",null));n["default"]=P.exports}}]);